<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="assets/xml/rss.xsl" media="all"?><rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Odoo Open Treasures</title><link>http://blog.odooist.com/</link><description>Odoo discovered secrets</description><atom:link href="http://blog.odooist.com/rss.xml" rel="self" type="application/rss+xml"></atom:link><language>en</language><copyright>Contents Â© 2021 &lt;a href="mailto:odooist@gmail.com"&gt;Odooist&lt;/a&gt; </copyright><lastBuildDate>Sun, 10 Jan 2021 12:13:29 GMT</lastBuildDate><generator>Nikola (getnikola.com)</generator><docs>http://blogs.law.harvard.edu/tech/rss</docs><item><title>Detect upgrade procedure</title><link>http://blog.odooist.com/posts/detect-upgrade-procedure/</link><dc:creator>Odooist</dc:creator><description>&lt;div&gt;&lt;p&gt;In Odoo it is possible to define model records in XML data files.&lt;/p&gt;
&lt;p&gt;During module upgrade procedure Odoo reads XML datafiles and updates database records defined there.&lt;/p&gt;
&lt;p&gt;But what if we need to have a conditional update? So that we do not update the records if
some condition is not met.&lt;/p&gt;
&lt;p&gt;To have this done we need to redefine &lt;em&gt;write&lt;/em&gt; method for the model and put there the following:&lt;/p&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_02c2db9eb28b420f9af7372ed6a04a2b-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a name="rest_code_02c2db9eb28b420f9af7372ed6a04a2b-2"&gt;&lt;/a&gt;    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;rec&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_02c2db9eb28b420f9af7372ed6a04a2b-3"&gt;&lt;/a&gt;        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;env&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'install_mode'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="ow"&gt;or&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;env&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
&lt;a name="rest_code_02c2db9eb28b420f9af7372ed6a04a2b-4"&gt;&lt;/a&gt;                &lt;span class="s1"&gt;'module'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s1"&gt;'your_module_name'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_02c2db9eb28b420f9af7372ed6a04a2b-5"&gt;&lt;/a&gt;            &lt;span class="n"&gt;logger&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'We are in upgrade procedure!'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_02c2db9eb28b420f9af7372ed6a04a2b-6"&gt;&lt;/a&gt;            &lt;span class="c1"&gt;# Check a condition&lt;/span&gt;
&lt;a name="rest_code_02c2db9eb28b420f9af7372ed6a04a2b-7"&gt;&lt;/a&gt;            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="bp"&gt;False&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_02c2db9eb28b420f9af7372ed6a04a2b-8"&gt;&lt;/a&gt;                &lt;span class="n"&gt;logger&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Ignoring updated record.'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_02c2db9eb28b420f9af7372ed6a04a2b-9"&gt;&lt;/a&gt;            &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_02c2db9eb28b420f9af7372ed6a04a2b-10"&gt;&lt;/a&gt;                &lt;span class="nb"&gt;super&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;MyCustomModel&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_02c2db9eb28b420f9af7372ed6a04a2b-11"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="bp"&gt;True&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;</description><category>upgrade</category><category>xml</category><guid>http://blog.odooist.com/posts/detect-upgrade-procedure/</guid><pubDate>Sun, 10 Jan 2021 12:00:27 GMT</pubDate></item><item><title>How to set language for controller</title><link>http://blog.odooist.com/posts/how-to-set-language-for-controller/</link><dc:creator>Odooist</dc:creator><description>&lt;div&gt;&lt;p&gt;Imagine that you have a signup procedure, like this:&lt;/p&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_dffdd4b638c9456d89b1c0f7dbd61622-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;MobileAppBaseController&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Controller&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a name="rest_code_dffdd4b638c9456d89b1c0f7dbd61622-2"&gt;&lt;/a&gt;  &lt;span class="nd"&gt;@http.route&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'/barrier/verify_user/1'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'json'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;auth&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'public'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a name="rest_code_dffdd4b638c9456d89b1c0f7dbd61622-3"&gt;&lt;/a&gt;              &lt;span class="n"&gt;methods&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'POST'&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;csrf&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;False&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_dffdd4b638c9456d89b1c0f7dbd61622-4"&gt;&lt;/a&gt;  &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;verify_user_step_1&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a name="rest_code_dffdd4b638c9456d89b1c0f7dbd61622-5"&gt;&lt;/a&gt;      &lt;span class="n"&gt;user_name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;jsonrequest&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'username'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_dffdd4b638c9456d89b1c0f7dbd61622-6"&gt;&lt;/a&gt;      &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="n"&gt;user_name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_dffdd4b638c9456d89b1c0f7dbd61622-7"&gt;&lt;/a&gt;          &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;'status'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="bp"&gt;False&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'msg'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;_&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'User name not sent.'&lt;/span&gt;&lt;span class="p"&gt;)}&lt;/span&gt;
&lt;a name="rest_code_dffdd4b638c9456d89b1c0f7dbd61622-8"&gt;&lt;/a&gt;      &lt;span class="o"&gt;...&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;When user name is not specified in JSON request it returns 'User name not sent' message.&lt;/p&gt;
&lt;p&gt;Now we want this message to be returned in different languages.&lt;/p&gt;
&lt;p&gt;After learning fron &lt;em&gt;odoo/tools/translation.py&lt;/em&gt; and &lt;em&gt;odoo/http.py&lt;/em&gt; two solutions where found.&lt;/p&gt;
&lt;div class="section" id="language-selection-by-client"&gt;
&lt;h2&gt;1. Language selection by client&lt;/h2&gt;
&lt;p&gt;To request messages translated into specified language Accept-Language header is used:&lt;/p&gt;
&lt;pre class="code sh"&gt;&lt;a name="rest_code_a81d41ce1073403aa20d236c1e7ecc7a-1"&gt;&lt;/a&gt;http -vv --json &lt;span class="s1"&gt;'http://127.0.0.1:38069/barrier/verify_user/1'&lt;/span&gt; &lt;span class="s2"&gt;"_username=user"&lt;/span&gt; &lt;span class="s1"&gt;'Accept-Language:ru'&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;Result:&lt;/p&gt;
&lt;pre class="code sh"&gt;&lt;a name="rest_code_c98b04c3539245a98816f9a10ddb8c4d-1"&gt;&lt;/a&gt;odooist@MacBook-Pro app % http -v --json &lt;span class="s1"&gt;'http://127.0.0.1:38069/barrier/verify_user/1'&lt;/span&gt; &lt;span class="s2"&gt;"_username=user"&lt;/span&gt; &lt;span class="s1"&gt;'Accept-Language:ru'&lt;/span&gt;
&lt;a name="rest_code_c98b04c3539245a98816f9a10ddb8c4d-2"&gt;&lt;/a&gt;POST /barrier/verify_user/1 HTTP/1.1
&lt;a name="rest_code_c98b04c3539245a98816f9a10ddb8c4d-3"&gt;&lt;/a&gt;Accept: application/json, */*
&lt;a name="rest_code_c98b04c3539245a98816f9a10ddb8c4d-4"&gt;&lt;/a&gt;Accept-Encoding: gzip, deflate
&lt;a name="rest_code_c98b04c3539245a98816f9a10ddb8c4d-5"&gt;&lt;/a&gt;Accept-Language: ru
&lt;a name="rest_code_c98b04c3539245a98816f9a10ddb8c4d-6"&gt;&lt;/a&gt;Connection: keep-alive
&lt;a name="rest_code_c98b04c3539245a98816f9a10ddb8c4d-7"&gt;&lt;/a&gt;Content-Length: &lt;span class="m"&gt;21&lt;/span&gt;
&lt;a name="rest_code_c98b04c3539245a98816f9a10ddb8c4d-8"&gt;&lt;/a&gt;Content-Type: application/json
&lt;a name="rest_code_c98b04c3539245a98816f9a10ddb8c4d-9"&gt;&lt;/a&gt;Host: &lt;span class="m"&gt;127&lt;/span&gt;.0.0.1:38069
&lt;a name="rest_code_c98b04c3539245a98816f9a10ddb8c4d-10"&gt;&lt;/a&gt;User-Agent: HTTPie/1.0.3
&lt;a name="rest_code_c98b04c3539245a98816f9a10ddb8c4d-11"&gt;&lt;/a&gt;
&lt;a name="rest_code_c98b04c3539245a98816f9a10ddb8c4d-12"&gt;&lt;/a&gt; &lt;span class="o"&gt;{&lt;/span&gt;
&lt;a name="rest_code_c98b04c3539245a98816f9a10ddb8c4d-13"&gt;&lt;/a&gt;    &lt;span class="s2"&gt;"_username"&lt;/span&gt;: &lt;span class="s2"&gt;"user"&lt;/span&gt;
&lt;a name="rest_code_c98b04c3539245a98816f9a10ddb8c4d-14"&gt;&lt;/a&gt; &lt;span class="o"&gt;}&lt;/span&gt;
&lt;a name="rest_code_c98b04c3539245a98816f9a10ddb8c4d-15"&gt;&lt;/a&gt;
&lt;a name="rest_code_c98b04c3539245a98816f9a10ddb8c4d-16"&gt;&lt;/a&gt;HTTP/1.0 &lt;span class="m"&gt;200&lt;/span&gt; OK
&lt;a name="rest_code_c98b04c3539245a98816f9a10ddb8c4d-17"&gt;&lt;/a&gt;Content-Length: &lt;span class="m"&gt;224&lt;/span&gt;
&lt;a name="rest_code_c98b04c3539245a98816f9a10ddb8c4d-18"&gt;&lt;/a&gt;Content-Type: application/json
&lt;a name="rest_code_c98b04c3539245a98816f9a10ddb8c4d-19"&gt;&lt;/a&gt;Date: Sat, &lt;span class="m"&gt;28&lt;/span&gt; Dec &lt;span class="m"&gt;2019&lt;/span&gt; &lt;span class="m"&gt;11&lt;/span&gt;:33:49 GMT
&lt;a name="rest_code_c98b04c3539245a98816f9a10ddb8c4d-20"&gt;&lt;/a&gt;Server: Werkzeug/0.16.0 Python/3.5.3
&lt;a name="rest_code_c98b04c3539245a98816f9a10ddb8c4d-21"&gt;&lt;/a&gt;Set-Cookie: &lt;span class="nv"&gt;session_id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;7b62bc401c248052e8a0ffb7626b7122340f774a&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="nv"&gt;Expires&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;Fri, &lt;span class="m"&gt;27&lt;/span&gt;-Mar-2020 &lt;span class="m"&gt;11&lt;/span&gt;:33:49 GMT&lt;span class="p"&gt;;&lt;/span&gt; Max-Age&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;7776000&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; HttpOnly&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="nv"&gt;Path&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;/
&lt;a name="rest_code_c98b04c3539245a98816f9a10ddb8c4d-22"&gt;&lt;/a&gt;
&lt;a name="rest_code_c98b04c3539245a98816f9a10ddb8c4d-23"&gt;&lt;/a&gt;&lt;span class="o"&gt;{&lt;/span&gt;
&lt;a name="rest_code_c98b04c3539245a98816f9a10ddb8c4d-24"&gt;&lt;/a&gt;  &lt;span class="s2"&gt;"id"&lt;/span&gt;: null,
&lt;a name="rest_code_c98b04c3539245a98816f9a10ddb8c4d-25"&gt;&lt;/a&gt;  &lt;span class="s2"&gt;"jsonrpc"&lt;/span&gt;: &lt;span class="s2"&gt;"2.0"&lt;/span&gt;,
&lt;a name="rest_code_c98b04c3539245a98816f9a10ddb8c4d-26"&gt;&lt;/a&gt;  &lt;span class="s2"&gt;"result"&lt;/span&gt;: &lt;span class="o"&gt;{&lt;/span&gt;
&lt;a name="rest_code_c98b04c3539245a98816f9a10ddb8c4d-27"&gt;&lt;/a&gt;      &lt;span class="s2"&gt;"msg"&lt;/span&gt;: &lt;span class="s2"&gt;"ĞĞ¼Ñ Ğ¿Ğ¾Ğ»ÑĞ·Ğ¾Ğ²Ğ°ÑĞµĞ»Ñ Ğ½Ğµ Ğ¾ÑĞ¾ÑĞ»Ğ°Ğ½Ğ¾."&lt;/span&gt;,
&lt;a name="rest_code_c98b04c3539245a98816f9a10ddb8c4d-28"&gt;&lt;/a&gt;      &lt;span class="s2"&gt;"status"&lt;/span&gt;: &lt;span class="nb"&gt;false&lt;/span&gt;
&lt;a name="rest_code_c98b04c3539245a98816f9a10ddb8c4d-29"&gt;&lt;/a&gt;  &lt;span class="o"&gt;}&lt;/span&gt;
&lt;a name="rest_code_c98b04c3539245a98816f9a10ddb8c4d-30"&gt;&lt;/a&gt;&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;As you can see in request headers Accept-Language is set to &lt;em&gt;ru&lt;/em&gt;, and in result we got msg translated.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="define-response-language-at-server"&gt;
&lt;h2&gt;2. Define response language at server&lt;/h2&gt;
&lt;p&gt;In &lt;em&gt;odoo/tools/translation.py&lt;/em&gt; interesting code was found:&lt;/p&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_43bbe7e098114a0599efe7a694f44c68-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;_get_lang&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;frame&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a name="rest_code_43bbe7e098114a0599efe7a694f44c68-2"&gt;&lt;/a&gt;    &lt;span class="c1"&gt;# try, in order: context.get('lang'), kwargs['context'].get('lang'),&lt;/span&gt;
&lt;a name="rest_code_43bbe7e098114a0599efe7a694f44c68-3"&gt;&lt;/a&gt;    &lt;span class="c1"&gt;# self.env.lang, self.localcontext.get('lang'), request.env.lang&lt;/span&gt;
&lt;a name="rest_code_43bbe7e098114a0599efe7a694f44c68-4"&gt;&lt;/a&gt;    &lt;span class="n"&gt;lang&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;
&lt;a name="rest_code_43bbe7e098114a0599efe7a694f44c68-5"&gt;&lt;/a&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;frame&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;f_locals&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'context'&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a name="rest_code_43bbe7e098114a0599efe7a694f44c68-6"&gt;&lt;/a&gt;        &lt;span class="n"&gt;lang&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;frame&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;f_locals&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'context'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'lang'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_43bbe7e098114a0599efe7a694f44c68-7"&gt;&lt;/a&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="n"&gt;lang&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_43bbe7e098114a0599efe7a694f44c68-8"&gt;&lt;/a&gt;        &lt;span class="n"&gt;kwargs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;frame&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;f_locals&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'kwargs'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;{})&lt;/span&gt;
&lt;a name="rest_code_43bbe7e098114a0599efe7a694f44c68-9"&gt;&lt;/a&gt;        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'context'&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a name="rest_code_43bbe7e098114a0599efe7a694f44c68-10"&gt;&lt;/a&gt;            &lt;span class="n"&gt;lang&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'context'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'lang'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_43bbe7e098114a0599efe7a694f44c68-11"&gt;&lt;/a&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="n"&gt;lang&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_43bbe7e098114a0599efe7a694f44c68-12"&gt;&lt;/a&gt;        &lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;frame&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;f_locals&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'self'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_43bbe7e098114a0599efe7a694f44c68-13"&gt;&lt;/a&gt;        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nb"&gt;hasattr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'env'&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a name="rest_code_43bbe7e098114a0599efe7a694f44c68-14"&gt;&lt;/a&gt;            &lt;span class="n"&gt;lang&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;env&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;lang&lt;/span&gt;
&lt;a name="rest_code_43bbe7e098114a0599efe7a694f44c68-15"&gt;&lt;/a&gt;        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="n"&gt;lang&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_43bbe7e098114a0599efe7a694f44c68-16"&gt;&lt;/a&gt;            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nb"&gt;hasattr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'localcontext'&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a name="rest_code_43bbe7e098114a0599efe7a694f44c68-17"&gt;&lt;/a&gt;                &lt;span class="n"&gt;lang&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;localcontext&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'lang'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_43bbe7e098114a0599efe7a694f44c68-18"&gt;&lt;/a&gt;        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="n"&gt;lang&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_43bbe7e098114a0599efe7a694f44c68-19"&gt;&lt;/a&gt;            &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_43bbe7e098114a0599efe7a694f44c68-20"&gt;&lt;/a&gt;                &lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;odoo.http&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;request&lt;/span&gt;
&lt;a name="rest_code_43bbe7e098114a0599efe7a694f44c68-21"&gt;&lt;/a&gt;                &lt;span class="n"&gt;lang&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;env&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;lang&lt;/span&gt;
&lt;a name="rest_code_43bbe7e098114a0599efe7a694f44c68-22"&gt;&lt;/a&gt;            &lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="ne"&gt;RuntimeError&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_43bbe7e098114a0599efe7a694f44c68-23"&gt;&lt;/a&gt;                &lt;span class="k"&gt;pass&lt;/span&gt;
&lt;a name="rest_code_43bbe7e098114a0599efe7a694f44c68-24"&gt;&lt;/a&gt;        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="n"&gt;lang&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_43bbe7e098114a0599efe7a694f44c68-25"&gt;&lt;/a&gt;            &lt;span class="c1"&gt;# Last resort: attempt to guess the language of the user&lt;/span&gt;
&lt;a name="rest_code_43bbe7e098114a0599efe7a694f44c68-26"&gt;&lt;/a&gt;            &lt;span class="c1"&gt;# Pitfall: some operations are performed in sudo mode, and we&lt;/span&gt;
&lt;a name="rest_code_43bbe7e098114a0599efe7a694f44c68-27"&gt;&lt;/a&gt;            &lt;span class="c1"&gt;#          don't know the original uid, so the language may&lt;/span&gt;
&lt;a name="rest_code_43bbe7e098114a0599efe7a694f44c68-28"&gt;&lt;/a&gt;            &lt;span class="c1"&gt;#          be wrong when the admin language differs.&lt;/span&gt;
&lt;a name="rest_code_43bbe7e098114a0599efe7a694f44c68-29"&gt;&lt;/a&gt;            &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cr&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dummy&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_get_cr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;frame&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;allow_create&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;False&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_43bbe7e098114a0599efe7a694f44c68-30"&gt;&lt;/a&gt;            &lt;span class="n"&gt;uid&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_get_uid&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;frame&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_43bbe7e098114a0599efe7a694f44c68-31"&gt;&lt;/a&gt;            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;cr&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="n"&gt;uid&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_43bbe7e098114a0599efe7a694f44c68-32"&gt;&lt;/a&gt;                &lt;span class="n"&gt;env&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;odoo&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;api&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Environment&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cr&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;uid&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;{})&lt;/span&gt;
&lt;a name="rest_code_43bbe7e098114a0599efe7a694f44c68-33"&gt;&lt;/a&gt;                &lt;span class="n"&gt;lang&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;env&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'res.users'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;context_get&lt;/span&gt;&lt;span class="p"&gt;()[&lt;/span&gt;&lt;span class="s1"&gt;'lang'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a name="rest_code_43bbe7e098114a0599efe7a694f44c68-34"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;lang&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;So to define server response language we had to put a context dictionary on a
function level like this (line 5):&lt;/p&gt;
&lt;table class="codetable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;&lt;a href="http://blog.odooist.com/posts/how-to-set-language-for-controller/#rest_code_173df031def64d8097e798c573744558-1"&gt;1&lt;/a&gt;
&lt;a href="http://blog.odooist.com/posts/how-to-set-language-for-controller/#rest_code_173df031def64d8097e798c573744558-2"&gt;2&lt;/a&gt;
&lt;a href="http://blog.odooist.com/posts/how-to-set-language-for-controller/#rest_code_173df031def64d8097e798c573744558-3"&gt;3&lt;/a&gt;
&lt;a href="http://blog.odooist.com/posts/how-to-set-language-for-controller/#rest_code_173df031def64d8097e798c573744558-4"&gt;4&lt;/a&gt;
&lt;a href="http://blog.odooist.com/posts/how-to-set-language-for-controller/#rest_code_173df031def64d8097e798c573744558-5"&gt;5&lt;/a&gt;
&lt;a href="http://blog.odooist.com/posts/how-to-set-language-for-controller/#rest_code_173df031def64d8097e798c573744558-6"&gt;6&lt;/a&gt;
&lt;a href="http://blog.odooist.com/posts/how-to-set-language-for-controller/#rest_code_173df031def64d8097e798c573744558-7"&gt;7&lt;/a&gt;
&lt;a href="http://blog.odooist.com/posts/how-to-set-language-for-controller/#rest_code_173df031def64d8097e798c573744558-8"&gt;8&lt;/a&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre class="code python"&gt;&lt;a name="rest_code_173df031def64d8097e798c573744558-1"&gt;&lt;/a&gt;   &lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;MobileAppBaseController&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Controller&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a name="rest_code_173df031def64d8097e798c573744558-2"&gt;&lt;/a&gt;     &lt;span class="nd"&gt;@http.route&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'/barrier/verify_user/1'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'json'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;auth&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'public'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a name="rest_code_173df031def64d8097e798c573744558-3"&gt;&lt;/a&gt;                 &lt;span class="n"&gt;methods&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'POST'&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;csrf&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;False&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_173df031def64d8097e798c573744558-4"&gt;&lt;/a&gt;     &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;verify_user_step_1&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a name="rest_code_173df031def64d8097e798c573744558-5"&gt;&lt;/a&gt;         &lt;span class="n"&gt;context&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;'language'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;'ru_RU'&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;a name="rest_code_173df031def64d8097e798c573744558-6"&gt;&lt;/a&gt;         &lt;span class="n"&gt;user_name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;jsonrequest&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'username'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_173df031def64d8097e798c573744558-7"&gt;&lt;/a&gt;         &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="n"&gt;user_name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_173df031def64d8097e798c573744558-8"&gt;&lt;/a&gt;             &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;'status'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="bp"&gt;False&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'msg'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;_&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'User name not sent.'&lt;/span&gt;&lt;span class="p"&gt;)}&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;&lt;strong&gt;Notice&lt;/strong&gt; that in the first case we added &lt;em&gt;Accept-Language: ru&lt;/em&gt;, but in the second one we
set language to &lt;em&gt;ru_RU&lt;/em&gt;.&lt;/p&gt;
&lt;/div&gt;&lt;/div&gt;</description><category>controller</category><category>i18n</category><guid>http://blog.odooist.com/posts/how-to-set-language-for-controller/</guid><pubDate>Sat, 28 Dec 2019 11:25:16 GMT</pubDate></item><item><title>Working with Savepoint</title><link>http://blog.odooist.com/posts/working-with-savepoint/</link><dc:creator>Odooist</dc:creator><description>&lt;div&gt;&lt;p&gt;Here I'll write about Odoo transactions.&lt;/p&gt;
&lt;p&gt;It's a general recommendation to let Odoo manage transactions and Odoo does it
quite well.&lt;/p&gt;
&lt;p&gt;By default a new transaction is opened on every HTTP request thus covering the whole bunch of
operations the method executed.&lt;/p&gt;
&lt;p&gt;If an exception happends during any method execution the whole transation is
rolled back and error is returned.&lt;/p&gt;
&lt;p&gt;But sometimes we need to keep some amount of work done in the middle of request and if the rest of the request fails we are saved.&lt;/p&gt;
&lt;p&gt;This is done by using &lt;code class="docutils literal"&gt;self.env.cr.commit()&lt;/code&gt; call.&lt;/p&gt;
&lt;div class="section" id="savepoint"&gt;
&lt;h2&gt;Savepoint&lt;/h2&gt;
&lt;p&gt;Savepoint defines a new saving point in current transation. So when an error occurs the transation
is rolled back to that point.&lt;/p&gt;
&lt;p&gt;If no error happens &lt;code class="docutils literal"&gt;RELEASE SAVEPOINT&lt;/code&gt; is called to  keep the effects of commands
executed after the savepoint was established.&lt;/p&gt;
&lt;p&gt;Here is the code snippet from &lt;code class="docutils literal"&gt;odoo/sql_db.py&lt;/code&gt;:&lt;/p&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_50ec7c82153a443f91a175e329d6d67a-1"&gt;&lt;/a&gt;&lt;span class="nd"&gt;@contextmanager&lt;/span&gt;
&lt;a name="rest_code_50ec7c82153a443f91a175e329d6d67a-2"&gt;&lt;/a&gt;&lt;span class="nd"&gt;@check&lt;/span&gt;
&lt;a name="rest_code_50ec7c82153a443f91a175e329d6d67a-3"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;savepoint&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;flush&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a name="rest_code_50ec7c82153a443f91a175e329d6d67a-4"&gt;&lt;/a&gt;    &lt;span class="sd"&gt;"""context manager entering in a new savepoint"""&lt;/span&gt;
&lt;a name="rest_code_50ec7c82153a443f91a175e329d6d67a-5"&gt;&lt;/a&gt;    &lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;uuid&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;uuid1&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;hex&lt;/span&gt;
&lt;a name="rest_code_50ec7c82153a443f91a175e329d6d67a-6"&gt;&lt;/a&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;flush&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_50ec7c82153a443f91a175e329d6d67a-7"&gt;&lt;/a&gt;        &lt;span class="n"&gt;flush_env&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_50ec7c82153a443f91a175e329d6d67a-8"&gt;&lt;/a&gt;    &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;execute&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'SAVEPOINT "&lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s1"&gt;"'&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_50ec7c82153a443f91a175e329d6d67a-9"&gt;&lt;/a&gt;    &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_50ec7c82153a443f91a175e329d6d67a-10"&gt;&lt;/a&gt;        &lt;span class="k"&gt;yield&lt;/span&gt;
&lt;a name="rest_code_50ec7c82153a443f91a175e329d6d67a-11"&gt;&lt;/a&gt;        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;flush&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_50ec7c82153a443f91a175e329d6d67a-12"&gt;&lt;/a&gt;            &lt;span class="n"&gt;flush_env&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_50ec7c82153a443f91a175e329d6d67a-13"&gt;&lt;/a&gt;    &lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="ne"&gt;Exception&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_50ec7c82153a443f91a175e329d6d67a-14"&gt;&lt;/a&gt;        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;flush&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_50ec7c82153a443f91a175e329d6d67a-15"&gt;&lt;/a&gt;            &lt;span class="n"&gt;clear_env&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_50ec7c82153a443f91a175e329d6d67a-16"&gt;&lt;/a&gt;        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;execute&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'ROLLBACK TO SAVEPOINT "&lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s1"&gt;"'&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_50ec7c82153a443f91a175e329d6d67a-17"&gt;&lt;/a&gt;        &lt;span class="k"&gt;raise&lt;/span&gt;
&lt;a name="rest_code_50ec7c82153a443f91a175e329d6d67a-18"&gt;&lt;/a&gt;    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_50ec7c82153a443f91a175e329d6d67a-19"&gt;&lt;/a&gt;        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;execute&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'RELEASE SAVEPOINT "&lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s1"&gt;"'&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</description><guid>http://blog.odooist.com/posts/working-with-savepoint/</guid><pubDate>Thu, 21 Nov 2019 07:35:18 GMT</pubDate></item><item><title>Form's initial mode</title><link>http://blog.odooist.com/posts/forms-initial-mode/</link><dc:creator>Odooist</dc:creator><description>&lt;div&gt;&lt;p&gt;When you click on a tree view row a form view is opened and this form is opened
in read mode.&lt;/p&gt;
&lt;p&gt;When you click the &lt;code class="docutils literal"&gt;Create&lt;/code&gt; button from a tree view, a new record form view is opened
in edit mode (how otherwise? :-)&lt;/p&gt;
&lt;p&gt;But sometimes it's more usable to immediately open an existing record in edit mode.&lt;/p&gt;
&lt;p&gt;This can be done using &lt;code class="docutils literal"&gt;form&lt;/code&gt; option &lt;code class="docutils literal"&gt;initial_mode&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;In different Odoo versions this can be done in different ways:&lt;/p&gt;
&lt;div class="section" id="id1"&gt;
&lt;h2&gt;10.0&lt;/h2&gt;
&lt;p&gt;In this version it can work in form declaration
(by chance as &lt;a class="reference external" href="https://github.com/odoo/odoo/issues/22353"&gt;developers say&lt;/a&gt;)
like in the following example:&lt;/p&gt;
&lt;pre class="code xml"&gt;&lt;a name="rest_code_a48725e744924159998d37254391b81a-1"&gt;&lt;/a&gt;&lt;span class="nt"&gt;&amp;lt;form&lt;/span&gt; &lt;span class="na"&gt;options=&lt;/span&gt;&lt;span class="s"&gt;"{'initial_mode': 'edit'}"&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;If transition from tree to form is done within python code:&lt;/p&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_b679e242d91d4c50880042a2c02bc972-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;a name="rest_code_b679e242d91d4c50880042a2c02bc972-2"&gt;&lt;/a&gt;    &lt;span class="s1"&gt;'name'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;action&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a name="rest_code_b679e242d91d4c50880042a2c02bc972-3"&gt;&lt;/a&gt;    &lt;span class="s1"&gt;'help'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;action&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;help&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a name="rest_code_b679e242d91d4c50880042a2c02bc972-4"&gt;&lt;/a&gt;    &lt;span class="s1"&gt;'type'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;action&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;type&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a name="rest_code_b679e242d91d4c50880042a2c02bc972-5"&gt;&lt;/a&gt;    &lt;span class="s1"&gt;'views'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[(&lt;/span&gt;&lt;span class="n"&gt;form_id&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'form'&lt;/span&gt;&lt;span class="p"&gt;)],&lt;/span&gt;
&lt;a name="rest_code_b679e242d91d4c50880042a2c02bc972-6"&gt;&lt;/a&gt;    &lt;span class="s1"&gt;'view_mode'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;'action.view_mode'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a name="rest_code_b679e242d91d4c50880042a2c02bc972-7"&gt;&lt;/a&gt;    &lt;span class="s1"&gt;'target'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;action&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a name="rest_code_b679e242d91d4c50880042a2c02bc972-8"&gt;&lt;/a&gt;    &lt;span class="s1"&gt;'context'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;action&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a name="rest_code_b679e242d91d4c50880042a2c02bc972-9"&gt;&lt;/a&gt;    &lt;span class="s1"&gt;'res_model'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;action&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;res_model&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a name="rest_code_b679e242d91d4c50880042a2c02bc972-10"&gt;&lt;/a&gt;    &lt;span class="s1"&gt;'flags'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;'initial_mode'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;'edit'&lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt;
&lt;a name="rest_code_b679e242d91d4c50880042a2c02bc972-11"&gt;&lt;/a&gt;    &lt;span class="s1"&gt;'res_id'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;record&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt;
&lt;a name="rest_code_b679e242d91d4c50880042a2c02bc972-12"&gt;&lt;/a&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;div class="section" id="id2"&gt;
&lt;h3&gt;11.0, 12.0, ...&lt;/h3&gt;
&lt;p&gt;Next Odoo versions "fix" the above and now you should use &lt;code class="docutils literal"&gt;context&lt;/code&gt;:&lt;/p&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_506b10388df8463db4a62163394a2f51-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;context&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;dict&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;env&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_506b10388df8463db4a62163394a2f51-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'form_view_initial_mode'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;'edit'&lt;/span&gt;
&lt;a name="rest_code_506b10388df8463db4a62163394a2f51-3"&gt;&lt;/a&gt;&lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;a name="rest_code_506b10388df8463db4a62163394a2f51-4"&gt;&lt;/a&gt;    &lt;span class="s1"&gt;'type'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;'ir.actions.act_window'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a name="rest_code_506b10388df8463db4a62163394a2f51-5"&gt;&lt;/a&gt;    &lt;span class="s1"&gt;'view_type'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;'form'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a name="rest_code_506b10388df8463db4a62163394a2f51-6"&gt;&lt;/a&gt;    &lt;span class="s1"&gt;'view_mode'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;'form'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a name="rest_code_506b10388df8463db4a62163394a2f51-7"&gt;&lt;/a&gt;    &lt;span class="s1"&gt;'res_model'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;'your.model'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a name="rest_code_506b10388df8463db4a62163394a2f51-8"&gt;&lt;/a&gt;    &lt;span class="s1"&gt;'res_id'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;your_object_id&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a name="rest_code_506b10388df8463db4a62163394a2f51-9"&gt;&lt;/a&gt;    &lt;span class="s1"&gt;'context'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a name="rest_code_506b10388df8463db4a62163394a2f51-10"&gt;&lt;/a&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;&lt;span class="emoji"&gt;ğ&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;/div&gt;</description><category>views</category><guid>http://blog.odooist.com/posts/forms-initial-mode/</guid><pubDate>Sat, 16 Nov 2019 03:21:21 GMT</pubDate></item><item><title>New xpath element named "move"</title><link>http://blog.odooist.com/posts/new-xpath-element-named-move/</link><dc:creator>Odooist</dc:creator><description>&lt;div&gt;&lt;p&gt;The position='move' has been introduced to move an element in an inherited
view.&lt;/p&gt;
&lt;p&gt;It's used as&lt;/p&gt;
&lt;pre class="code xml"&gt;&lt;a name="rest_code_c6277706fb6c4e20beeacfed7c97ea35-1"&gt;&lt;/a&gt;&lt;span class="nt"&gt;&amp;lt;xpath&lt;/span&gt; &lt;span class="na"&gt;expr=&lt;/span&gt;&lt;span class="s"&gt;"//@target"&lt;/span&gt; &lt;span class="na"&gt;position=&lt;/span&gt;&lt;span class="s"&gt;"after"&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
&lt;a name="rest_code_c6277706fb6c4e20beeacfed7c97ea35-2"&gt;&lt;/a&gt;    &lt;span class="nt"&gt;&amp;lt;xpath&lt;/span&gt; &lt;span class="na"&gt;expr=&lt;/span&gt;&lt;span class="s"&gt;"//@node"&lt;/span&gt; &lt;span class="na"&gt;position=&lt;/span&gt;&lt;span class="s"&gt;"move"&lt;/span&gt;&lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
&lt;a name="rest_code_c6277706fb6c4e20beeacfed7c97ea35-3"&gt;&lt;/a&gt;&lt;span class="nt"&gt;&amp;lt;/xpath&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;Or also:&lt;/p&gt;
&lt;pre class="code xml"&gt;&lt;a name="rest_code_df4c01ad88744672b049b26160be4835-1"&gt;&lt;/a&gt;&lt;span class="nt"&gt;&amp;lt;field&lt;/span&gt; &lt;span class="na"&gt;name=&lt;/span&gt;&lt;span class="s"&gt;"target_field"&lt;/span&gt; &lt;span class="na"&gt;position=&lt;/span&gt;&lt;span class="s"&gt;"after"&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
&lt;a name="rest_code_df4c01ad88744672b049b26160be4835-2"&gt;&lt;/a&gt;    &lt;span class="nt"&gt;&amp;lt;field&lt;/span&gt; &lt;span class="na"&gt;name=&lt;/span&gt;&lt;span class="s"&gt;"my_field"&lt;/span&gt; &lt;span class="na"&gt;position=&lt;/span&gt;&lt;span class="s"&gt;"move"&lt;/span&gt;&lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
&lt;a name="rest_code_df4c01ad88744672b049b26160be4835-3"&gt;&lt;/a&gt;&lt;span class="nt"&gt;&amp;lt;/field&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;In the above example &lt;code class="docutils literal"&gt;my_field&lt;/code&gt; is placed &lt;em&gt;after&lt;/em&gt; &lt;code class="docutils literal"&gt;target_field&lt;/code&gt; in the parent form.&lt;/p&gt;
&lt;p&gt;So now we can inherit and have the ability to manipulate fields order in views, not only add
new fields.&lt;/p&gt;&lt;/div&gt;</description><category>12.0</category><category>inherit</category><category>views</category><category>xml</category><guid>http://blog.odooist.com/posts/new-xpath-element-named-move/</guid><pubDate>Fri, 15 Nov 2019 13:37:56 GMT</pubDate></item><item><title>Hiding entire tree column with column_invisible</title><link>http://blog.odooist.com/posts/hiding-entire-tree-column-with-column_invisible/</link><dc:creator>Odooist</dc:creator><description>&lt;div&gt;&lt;p&gt;We all know a way to hide a field in tree &amp;amp; form views using &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;attrs={'invisible':&lt;/span&gt; &lt;span class="pre"&gt;[(...)]}&lt;/span&gt;&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;We also know that we can hide &lt;strong&gt;entire column&lt;/strong&gt; using &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;invisible="1"&lt;/span&gt;&lt;/code&gt; attribute like this:&lt;/p&gt;
&lt;pre class="code xml"&gt;&lt;a name="rest_code_ee345fe991a84a3482fdd2720fea7e2a-1"&gt;&lt;/a&gt;&lt;span class="nt"&gt;&amp;lt;tree&lt;/span&gt; &lt;span class="na"&gt;decoration-warning=&lt;/span&gt;&lt;span class="s"&gt;"event_input_mode == True"&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
&lt;a name="rest_code_ee345fe991a84a3482fdd2720fea7e2a-2"&gt;&lt;/a&gt;    &lt;span class="nt"&gt;&amp;lt;field&lt;/span&gt; &lt;span class="na"&gt;name=&lt;/span&gt;&lt;span class="s"&gt;"event_input_mode"&lt;/span&gt; &lt;span class="na"&gt;invisible=&lt;/span&gt;&lt;span class="s"&gt;"1"&lt;/span&gt;&lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
&lt;a name="rest_code_ee345fe991a84a3482fdd2720fea7e2a-3"&gt;&lt;/a&gt;    &lt;span class="nt"&gt;&amp;lt;field&lt;/span&gt; &lt;span class="na"&gt;name=&lt;/span&gt;&lt;span class="s"&gt;"description"&lt;/span&gt;&lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
&lt;a name="rest_code_ee345fe991a84a3482fdd2720fea7e2a-4"&gt;&lt;/a&gt;    &lt;span class="nt"&gt;&amp;lt;field&lt;/span&gt; &lt;span class="na"&gt;name=&lt;/span&gt;&lt;span class="s"&gt;"facility"&lt;/span&gt; &lt;span class="na"&gt;invisible=&lt;/span&gt;&lt;span class="s"&gt;"context.get('hide_facility')"&lt;/span&gt;&lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
&lt;a name="rest_code_ee345fe991a84a3482fdd2720fea7e2a-5"&gt;&lt;/a&gt;    &lt;span class="nt"&gt;&amp;lt;field&lt;/span&gt; &lt;span class="na"&gt;name=&lt;/span&gt;&lt;span class="s"&gt;"uid"&lt;/span&gt;&lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
&lt;a name="rest_code_ee345fe991a84a3482fdd2720fea7e2a-6"&gt;&lt;/a&gt;&lt;span class="nt"&gt;&amp;lt;/tree&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;In the above example we need &lt;code class="docutils literal"&gt;event_input_mode&lt;/code&gt; column just to highlight a row if
it have &lt;code class="docutils literal"&gt;event_input_mode&lt;/code&gt; set so we hide it with &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;invisible="1"&lt;/span&gt;&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;We can also notice that we can use &lt;code class="docutils literal"&gt;context&lt;/code&gt; values in condition expression.
In the above example if &lt;code class="docutils literal"&gt;context&lt;/code&gt; has &lt;code class="docutils literal"&gt;hide_facility&lt;/code&gt; key then entire column is hidden.&lt;/p&gt;
&lt;div class="section" id="the-treasure"&gt;
&lt;h2&gt;The treasure&lt;/h2&gt;
&lt;p&gt;But what if you need to hide entire column by a condition coming from complex business
logic implemented in Python?&lt;/p&gt;
&lt;p&gt;Here &lt;strong&gt;column_invisible&lt;/strong&gt; attribute comes!&lt;/p&gt;
&lt;p&gt;See this examples:&lt;/p&gt;
&lt;pre class="code xml"&gt;&lt;a name="rest_code_587fb9f953b8427fa3a2fc1a1d9bca7b-1"&gt;&lt;/a&gt;&lt;span class="nt"&gt;&amp;lt;tree&amp;gt;&lt;/span&gt;
&lt;a name="rest_code_587fb9f953b8427fa3a2fc1a1d9bca7b-2"&gt;&lt;/a&gt;    ...
&lt;a name="rest_code_587fb9f953b8427fa3a2fc1a1d9bca7b-3"&gt;&lt;/a&gt;    &lt;span class="nt"&gt;&amp;lt;field&lt;/span&gt; &lt;span class="na"&gt;name=&lt;/span&gt;&lt;span class="s"&gt;"foo"&lt;/span&gt; &lt;span class="na"&gt;attrs=&lt;/span&gt;&lt;span class="s"&gt;"{'column_invisible': [('parent.product_id', '!=', False)]}"&lt;/span&gt;&lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
&lt;a name="rest_code_587fb9f953b8427fa3a2fc1a1d9bca7b-4"&gt;&lt;/a&gt;    ...
&lt;a name="rest_code_587fb9f953b8427fa3a2fc1a1d9bca7b-5"&gt;&lt;/a&gt;&lt;span class="nt"&gt;&amp;lt;/tree&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;By digging the source code I can see &lt;code class="docutils literal"&gt;column_invisible&lt;/code&gt; was introduced in Odoo 11.0.&lt;/p&gt;
&lt;p&gt;Nice, but works &lt;strong&gt;only&lt;/strong&gt; for &lt;code class="docutils literal"&gt;many2one&lt;/code&gt; and &lt;code class="docutils literal"&gt;one2many&lt;/code&gt; fields :-)&lt;/p&gt;
&lt;/div&gt;&lt;/div&gt;</description><category>11.0</category><category>12.0</category><category>views</category><guid>http://blog.odooist.com/posts/hiding-entire-tree-column-with-column_invisible/</guid><pubDate>Fri, 15 Nov 2019 11:15:55 GMT</pubDate></item></channel></rss>