<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="../assets/xml/rss.xsl" media="all"?><rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Odoo Open Treasures (Posts about xml)</title><link>http://blog.odooist.com/</link><description></description><atom:link href="http://blog.odooist.com/categories/xml.xml" rel="self" type="application/rss+xml"></atom:link><language>en</language><copyright>Contents Â© 2021 &lt;a href="mailto:odooist@gmail.com"&gt;Odooist&lt;/a&gt; </copyright><lastBuildDate>Fri, 05 Mar 2021 07:17:55 GMT</lastBuildDate><generator>Nikola (getnikola.com)</generator><docs>http://blogs.law.harvard.edu/tech/rss</docs><item><title>Detect upgrade procedure</title><link>http://blog.odooist.com/posts/detect-upgrade-procedure/</link><dc:creator>Odooist</dc:creator><description>&lt;div&gt;&lt;p&gt;In Odoo it is possible to define model records in XML data files.&lt;/p&gt;
&lt;p&gt;During module upgrade procedure Odoo reads XML datafiles and updates database records defined there.&lt;/p&gt;
&lt;p&gt;But what if we need to have a conditional update? So that we do not update the records if
some condition is not met.&lt;/p&gt;
&lt;p&gt;To have this done we need to redefine &lt;em&gt;write&lt;/em&gt; method for the model and put there the following:&lt;/p&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_3a20fca625c74136bd6cd83b2fc66b0f-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a name="rest_code_3a20fca625c74136bd6cd83b2fc66b0f-2"&gt;&lt;/a&gt;    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;rec&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_3a20fca625c74136bd6cd83b2fc66b0f-3"&gt;&lt;/a&gt;        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;env&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'install_mode'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="ow"&gt;or&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;env&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
&lt;a name="rest_code_3a20fca625c74136bd6cd83b2fc66b0f-4"&gt;&lt;/a&gt;                &lt;span class="s1"&gt;'module'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s1"&gt;'your_module_name'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_3a20fca625c74136bd6cd83b2fc66b0f-5"&gt;&lt;/a&gt;            &lt;span class="n"&gt;logger&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'We are in upgrade procedure!'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_3a20fca625c74136bd6cd83b2fc66b0f-6"&gt;&lt;/a&gt;            &lt;span class="c1"&gt;# Check a condition&lt;/span&gt;
&lt;a name="rest_code_3a20fca625c74136bd6cd83b2fc66b0f-7"&gt;&lt;/a&gt;            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_3a20fca625c74136bd6cd83b2fc66b0f-8"&gt;&lt;/a&gt;                &lt;span class="n"&gt;logger&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Ignoring updated record.'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_3a20fca625c74136bd6cd83b2fc66b0f-9"&gt;&lt;/a&gt;            &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_3a20fca625c74136bd6cd83b2fc66b0f-10"&gt;&lt;/a&gt;                &lt;span class="nb"&gt;super&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;MyCustomModel&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_3a20fca625c74136bd6cd83b2fc66b0f-11"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="kc"&gt;True&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;</description><category>upgrade</category><category>xml</category><guid>http://blog.odooist.com/posts/detect-upgrade-procedure/</guid><pubDate>Sun, 10 Jan 2021 12:00:27 GMT</pubDate></item><item><title>New xpath element named "move"</title><link>http://blog.odooist.com/posts/new-xpath-element-named-move/</link><dc:creator>Odooist</dc:creator><description>&lt;div&gt;&lt;p&gt;The position='move' has been introduced to move an element in an inherited
view.&lt;/p&gt;
&lt;p&gt;It's used as&lt;/p&gt;
&lt;pre class="code xml"&gt;&lt;a name="rest_code_c6277706fb6c4e20beeacfed7c97ea35-1"&gt;&lt;/a&gt;&lt;span class="nt"&gt;&amp;lt;xpath&lt;/span&gt; &lt;span class="na"&gt;expr=&lt;/span&gt;&lt;span class="s"&gt;"//@target"&lt;/span&gt; &lt;span class="na"&gt;position=&lt;/span&gt;&lt;span class="s"&gt;"after"&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
&lt;a name="rest_code_c6277706fb6c4e20beeacfed7c97ea35-2"&gt;&lt;/a&gt;    &lt;span class="nt"&gt;&amp;lt;xpath&lt;/span&gt; &lt;span class="na"&gt;expr=&lt;/span&gt;&lt;span class="s"&gt;"//@node"&lt;/span&gt; &lt;span class="na"&gt;position=&lt;/span&gt;&lt;span class="s"&gt;"move"&lt;/span&gt;&lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
&lt;a name="rest_code_c6277706fb6c4e20beeacfed7c97ea35-3"&gt;&lt;/a&gt;&lt;span class="nt"&gt;&amp;lt;/xpath&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;Or also:&lt;/p&gt;
&lt;pre class="code xml"&gt;&lt;a name="rest_code_df4c01ad88744672b049b26160be4835-1"&gt;&lt;/a&gt;&lt;span class="nt"&gt;&amp;lt;field&lt;/span&gt; &lt;span class="na"&gt;name=&lt;/span&gt;&lt;span class="s"&gt;"target_field"&lt;/span&gt; &lt;span class="na"&gt;position=&lt;/span&gt;&lt;span class="s"&gt;"after"&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
&lt;a name="rest_code_df4c01ad88744672b049b26160be4835-2"&gt;&lt;/a&gt;    &lt;span class="nt"&gt;&amp;lt;field&lt;/span&gt; &lt;span class="na"&gt;name=&lt;/span&gt;&lt;span class="s"&gt;"my_field"&lt;/span&gt; &lt;span class="na"&gt;position=&lt;/span&gt;&lt;span class="s"&gt;"move"&lt;/span&gt;&lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
&lt;a name="rest_code_df4c01ad88744672b049b26160be4835-3"&gt;&lt;/a&gt;&lt;span class="nt"&gt;&amp;lt;/field&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;In the above example &lt;code class="docutils literal"&gt;my_field&lt;/code&gt; is placed &lt;em&gt;after&lt;/em&gt; &lt;code class="docutils literal"&gt;target_field&lt;/code&gt; in the parent form.&lt;/p&gt;
&lt;p&gt;So now we can inherit and have the ability to manipulate fields order in views, not only add
new fields.&lt;/p&gt;&lt;/div&gt;</description><category>12.0</category><category>inherit</category><category>views</category><category>xml</category><guid>http://blog.odooist.com/posts/new-xpath-element-named-move/</guid><pubDate>Fri, 15 Nov 2019 13:37:56 GMT</pubDate></item></channel></rss>